<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Pokec | English Edition</title>
    <style>
        :root { --pokec-blue: #0084ff; --pokec-bg: #f0f2f5; --border: #e1e4e8; }
        body { margin: 0; font-family: sans-serif; background: var(--pokec-bg); display: flex; flex-direction: column; height: 100vh; }

        /* Top Bar mimicking Azet/Pokec header */
        #top-header { background: #fff; border-bottom: 1px solid var(--border); padding: 8px 20px; display: flex; align-items: center; justify-content: space-between; }
        .logo-text { color: var(--pokec-blue); font-size: 24px; font-weight: bold; }

        /* 3-Column Layout */
        #main-wrapper { display: grid; grid-template-columns: 220px 1fr 250px; flex: 1; overflow: hidden; }

        /* LEFT: Miestnosti */
        .sidebar-left { background: #fff; border-right: 1px solid var(--border); padding: 15px; }
        .sidebar-title { font-weight: bold; color: #666; font-size: 14px; margin-bottom: 10px; }
        .room-btn { padding: 8px 12px; border-radius: 6px; cursor: pointer; display: flex; align-items: center; gap: 8px; font-size: 14px; margin-bottom: 2px; }
        .room-btn:hover { background: #f2f2f2; }
        .room-btn.active { background: #e7f3ff; color: var(--pokec-blue); font-weight: bold; }

        /* MIDDLE: Chat */
        .chat-container { display: flex; flex-direction: column; background: #fff; }
        #chat-header { padding: 10px 20px; border-bottom: 1px solid var(--border); display: flex; align-items: center; gap: 10px; }
        #message-flow { flex: 1; overflow-y: auto; padding: 15px; }
        
        /* Message Bubbles - Matching your screenshot */
        .msg-entry { display: flex; gap: 10px; margin-bottom: 12px; border-bottom: 1px solid #f9f9f9; padding-bottom: 8px; }
        .avatar { width: 40px; height: 40px; border-radius: 8px; background: #ddd; }
        .msg-info { flex: 1; }
        .username { font-weight: bold; color: var(--pokec-blue); font-size: 13px; }
        .timestamp { color: #999; font-size: 11px; margin-left: 8px; }
        .text { font-size: 14px; color: #333; margin-top: 2px; }

        /* BOTTOM: Input area */
        #input-box { padding: 15px; border-top: 1px solid var(--border); display: flex; gap: 10px; background: #fff; }
        #msg-field { flex: 1; padding: 10px 15px; border: 1px solid var(--border); border-radius: 20px; outline: none; background: #f0f2f5; }
        .send-btn { background: var(--pokec-blue); color: #fff; border: none; padding: 0 20px; border-radius: 20px; font-weight: bold; cursor: pointer; }

        /* RIGHT: Online Users */
        .sidebar-right { background: #fff; border-left: 1px solid var(--border); padding: 15px; }
    </style>
</head>
<body>

    <div id="top-header">
        <div class="logo-text">Pokec</div>
        <div id="me-status" style="font-size: 13px; font-weight: bold;"></div>
    </div>

    <div id="main-wrapper">
        <div class="sidebar-left">
            <div class="sidebar-title">Miestnosti</div>
            <div class="room-btn active">ðŸ˜Š Do pohody</div>
            <div class="room-btn">ðŸ‡¬ðŸ‡§ English Only</div>
            <div class="room-btn">ðŸŽ® Gaming</div>
        </div>

        <div class="chat-container">
            <div id="chat-header">
                <span style="font-size: 20px;">ðŸ˜Š</span>
                <strong id="room-title">Do pohody</strong>
            </div>
            <div id="message-flow">
                </div>
            <div id="input-box">
                <input type="text" id="msg-field" placeholder="NapÃ­Å¡ sprÃ¡vu..." onkeypress="if(event.key==='Enter') send()">
                <button class="send-btn" onclick="send()">OdoslaÅ¥</button>
            </div>
        </div>

        <div class="sidebar-right">
            <div class="sidebar-title">Ä½udia v miestnosti</div>
            <div id="user-list" style="font-size: 13px;"></div>
        </div>
    </div>

    <script>
        // Simple script to handle UI
        let user = JSON.parse(localStorage.getItem('user')) || { username: "Guest", email: "guest@guest.com" };
        document.getElementById('me-status').innerText = user.username;

        async function refresh() {
            const res = await fetch('/api/messages?room=General');
            const data = await res.json();
            const flow = document.getElementById('message-flow');
            flow.innerHTML = data.map(m => `
                <div class="msg-entry">
                    <img src="https://api.dicebear.com/7.x/avataaars/svg?seed=${m.username}" class="avatar">
                    <div class="msg-info">
                        <div><span class="username">${m.username}</span><span class="timestamp">${new Date(m.timestamp).toLocaleTimeString([], {hour:'2-digit', minute:'2-digit'})}</span></div>
                        <div class="text">${m.text}</div>
                    </div>
                </div>
            `).join('');
            flow.scrollTop = flow.scrollHeight;
        }

        async function send() {
            const input = document.getElementById('msg-field');
            if(!input.value) return;
            await fetch('/api/messages', {
                method: 'POST',
                headers: {'Content-Type': 'application/json'},
                body: JSON.stringify({ username: user.username, email: user.email, text: input.value, room: 'General' })
            });
            input.value = '';
            refresh();
        }

        setInterval(refresh, 3000);
        refresh();
    </script>
</body>
</html>